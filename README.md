# Overview

**cdskit** is a pre- and post-processing tool for protein-coding sequences. 
[All sequence formats supported by biopython](https://biopython.org/wiki/SeqIO) are also available in this tool for both input and output.

# Dependency
* [python 3.x](https://www.python.org/)
* [biopython](https://biopython.org/)
* [numpy](http://www.numpy.org/)

# Usage
Try `cdskit -h` for complete options.

# Example

## Padding truncated coding sequences to make them in-frame

`cdskit pad --seqfile input.fasta --outfile output.fasta`

#### input.fasta
```$xslt
>miss_1nt_5prime
TGGATTATGTTGAAGTGGCTTACAGTAGTATAAACACAGTCCCCACGGCCACCCGCAGAAGAGATGGTTCCCAGGTTCACCCGTTTGCTGTACGAGTAAACCCCCAGAGTGTCATTGGGCCTCAAATTGTATCCTTCCCGGCACACCATACAGGCCAGCCCATCCTCCTCTTCCTCCACGTCCTCCAGGCCTTCGATCGCCGGCTGCGAAACGACGATCCGCTCACCGCCGTCCGAAGCAAACTCTTGCCGCATGCCGAGGCCCTGGACATCTTCGATGACAAATCAGCGCATCATTCAGGAATGCAAGAACTGCAGAGAAAAGGAATACTGCTACCTGGAGCAACTCCTCCCTTTTTCTGA
>miss_2nt_5prime
GTCCTCCAGACAAGAGAGCAGCTCTTTCGAGAACCCGACCATCTCCTTCACATTCATCAGCCTCTCCTTCATTGCCGCCGTCCATCCGTCCGCGCCATCCTCCTCTGAAGGCCTCCTTGACAGCCGCTTGAAGAATCGCTGCAGCTGCTCAATCAAGCCCGTGTACACGACCATCGGCTGGATCGCCGAGAAGAACTGCTCCCTGCTGCTGTCGGTAGTGCCCAACGAGGATGGCGAAGGGGACCGCCCGTGA
>miss_1nt_3prime
ATGATTGAAATATTCGGAACAAACAGTATCCTCATCCACACTAACAGACGTTCCCGCTGCTGCTGCCGCCGCCGGAGGAGATGGCGAACCGAACAAAATCTTGGCAGGAAGAAAAGCCGGCAGAGAGAACATCCCCCAAAGCCCCGGCAGCATCAAAGGCCTCCTGAAGATCTCCGGCAGAGACCATGTCCTCCAGACAAGAGAGCAGCTCTTTCGAGAACCCGACCATCTCCTTCACATTCATCAGCCTCTCCTTCATTGCCGCCGTCCATCCGTCCGCGCCATCCTCCTCTGAAGGCCTCCTTGACAGCCGCTTG
>miss_2nt_3prime
ATGGATGCAGAGGCATTTTCGGAATTGCGAGTAAGCACCAGCTTCTCAGCATTTTTTTGGAAACCAACTGATTTTGGATTCAATGATGCTGATCCAAAACTATTATTTGTGCTGAGTTTTGATGGATATCTTTCAATGGACTTTTTGCTAGCTCCACAATCTCCCAAAAAAGAGCAAATAAAATTAAAAAGGAATTTTAGGCCGAGAAGAAAATCCTCGCTATCTGCAAGCTTCACCATTAGCTGCACAATTTTCTCCAAAAGTAGGTTCAACGATGCCATTCCATGCAAAAGCTGGAGCATAAAACCAAAAT
>miss_1nt_both
TGAATCCCTGTGAGACATCAATATTGAGGCTCCTCTCCTGTGAATTCACATTACCTACCTCCTGCCCTATTAGTCGACAGAGCATAGTTAAGAATCCCTTTGCTGTCAAAAAAAGACGAGCAGTTTCAGGATCTATCATTTTAAAGAATAGCTCAAAATATTCTGCTGCACTTTCACCGGTAGGCAGTGTTGAAGGAAGCAGCAACATAAGCAAGTTTAACAATTTGAATCGTCGCGGTGAATCTTGTGGACATAATAAACTGATGAGTGTACATACTTCAGATCTAATGGAGTG
>miss_2nt_both
GAGAACTATCTTTTTCGCCTGTTCGCCGGCACCGCTCTCTCCGTTGGTGACCGTGCGAACGCTCTCGGTGATGCCAATATCGCTCTCGTTAGCTTCCATCGTGAGGCTCTCCACGATCAGGAGAATGGCCTCTGCGAGCTCCATGGCTTCTACGGAGAAGGCGCGCCTTGCAGTCTCCAAAAGCATCCCCAGAGCCCCCAGGTGCAACAAAGCGCACCGATTCTCTCGTATCTTGCAGCAGTACATCAGAAGATTAAGCACTGAAGCCAATTCTTCAT
>complete
ATGTTGGGGCTAATCATGAAGATGAAGCCCTTTTTGGAAACCTTTTTTGTGAAGCTAACCGGCCTGTTGGATTACCAGATGGAGTCGAAGAACTACCCACAGCTGTTACTTTTGAAAGCTATCACTTGCCAATCCAAGCTGCTTCAGAATTACTGCTCTTTATTAAAGTTGGTATATTTTCCCCAGAATGGGATAATAGTATTTATGAGAATGCTTCCAGAATGGTCAATGAGAAGCACATTGATTGGCTTCTTCCTATTGTTGGTTGCCAGAATTATTTGTTTGAAGCAGAGAAGAGTACCACAGCTGTTTCAAATAGTGATATGCATGTGA
```

#### output.fasta
```$xslt
>miss_1nt_5prime
NTGGATTATGTTGAAGTGGCTTACAGTAGTATAAACACAGTCCCCACGGCCACCCGCAGAAGAGATGGTTCCCAGGTTCACCCGTTTGCTGTACGAGTAAACCCCCAGAGTGTCATTGGGCCTCAAATTGTATCCTTCCCGGCACACCATACAGGCCAGCCCATCCTCCTCTTCCTCCACGTCCTCCAGGCCTTCGATCGCCGGCTGCGAAACGACGATCCGCTCACCGCCGTCCGAAGCAAACTCTTGCCGCATGCCGAGGCCCTGGACATCTTCGATGACAAATCAGCGCATCATTCAGGAATGCAAGAACTGCAGAGAAAAGGAATACTGCTACCTGGAGCAACTCCTCCCTTTTTCTGA
>miss_2nt_5prime
NNGTCCTCCAGACAAGAGAGCAGCTCTTTCGAGAACCCGACCATCTCCTTCACATTCATCAGCCTCTCCTTCATTGCCGCCGTCCATCCGTCCGCGCCATCCTCCTCTGAAGGCCTCCTTGACAGCCGCTTGAAGAATCGCTGCAGCTGCTCAATCAAGCCCGTGTACACGACCATCGGCTGGATCGCCGAGAAGAACTGCTCCCTGCTGCTGTCGGTAGTGCCCAACGAGGATGGCGAAGGGGACCGCCCGTGA
>miss_1nt_3prime
ATGATTGAAATATTCGGAACAAACAGTATCCTCATCCACACTAACAGACGTTCCCGCTGCTGCTGCCGCCGCCGGAGGAGATGGCGAACCGAACAAAATCTTGGCAGGAAGAAAAGCCGGCAGAGAGAACATCCCCCAAAGCCCCGGCAGCATCAAAGGCCTCCTGAAGATCTCCGGCAGAGACCATGTCCTCCAGACAAGAGAGCAGCTCTTTCGAGAACCCGACCATCTCCTTCACATTCATCAGCCTCTCCTTCATTGCCGCCGTCCATCCGTCCGCGCCATCCTCCTCTGAAGGCCTCCTTGACAGCCGCTTGN
>miss_2nt_3prime
ATGGATGCAGAGGCATTTTCGGAATTGCGAGTAAGCACCAGCTTCTCAGCATTTTTTTGGAAACCAACTGATTTTGGATTCAATGATGCTGATCCAAAACTATTATTTGTGCTGAGTTTTGATGGATATCTTTCAATGGACTTTTTGCTAGCTCCACAATCTCCCAAAAAAGAGCAAATAAAATTAAAAAGGAATTTTAGGCCGAGAAGAAAATCCTCGCTATCTGCAAGCTTCACCATTAGCTGCACAATTTTCTCCAAAAGTAGGTTCAACGATGCCATTCCATGCAAAAGCTGGAGCATAAAACCAAAATNN
>miss_1nt_both
NTGAATCCCTGTGAGACATCAATATTGAGGCTCCTCTCCTGTGAATTCACATTACCTACCTCCTGCCCTATTAGTCGACAGAGCATAGTTAAGAATCCCTTTGCTGTCAAAAAAAGACGAGCAGTTTCAGGATCTATCATTTTAAAGAATAGCTCAAAATATTCTGCTGCACTTTCACCGGTAGGCAGTGTTGAAGGAAGCAGCAACATAAGCAAGTTTAACAATTTGAATCGTCGCGGTGAATCTTGTGGACATAATAAACTGATGAGTGTACATACTTCAGATCTAATGGAGTGN
>miss_2nt_both
NNGAGAACTATCTTTTTCGCCTGTTCGCCGGCACCGCTCTCTCCGTTGGTGACCGTGCGAACGCTCTCGGTGATGCCAATATCGCTCTCGTTAGCTTCCATCGTGAGGCTCTCCACGATCAGGAGAATGGCCTCTGCGAGCTCCATGGCTTCTACGGAGAAGGCGCGCCTTGCAGTCTCCAAAAGCATCCCCAGAGCCCCCAGGTGCAACAAAGCGCACCGATTCTCTCGTATCTTGCAGCAGTACATCAGAAGATTAAGCACTGAAGCCAATTCTTCATNN
>complete
ATGTTGGGGCTAATCATGAAGATGAAGCCCTTTTTGGAAACCTTTTTTGTGAAGCTAACCGGCCTGTTGGATTACCAGATGGAGTCGAAGAACTACCCACAGCTGTTACTTTTGAAAGCTATCACTTGCCAATCCAAGCTGCTTCAGAATTACTGCTCTTTATTAAAGTTGGTATATTTTCCCCAGAATGGGATAATAGTATTTATGAGAATGCTTCCAGAATGGTCAATGAGAAGCACATTGATTGGCTTCTTCCTATTGTTGGTTGCCAGAATTATTTGTTTGAAGCAGAGAAGAGTACCACAGCTGTTTCAAATAGTGATATGCATGTGA
```

## Extracting longest sequences among isoforms or other groups of sequences using regular expression

`cdskit aggregate --seqfile input.fasta --outfile output.fasta`

#### input.fasta
```$xslt
>seq1.1:333nt
ATGTTGGGGCTAATCATGAAGATGAAGCCCTTTTTGGAAACCTTTTTTGTGAAGCTAACCGGCCTGTTGGATTACCAGATGGAGTCGAAGAACTACCCACAGCTGTTACTTTTGAAAGCTATCACTTGCCAATCCAAGCTGCTTCAGAATTACTGCTCTTTATTAAAGTTGGTATATTTTCCCCAGAATGGGATAATAGTATTTATGAGAATGCTTCCAGAATGGTCAATGAGAAGCACATTGATTGGCTTCTTCCTATTGTTGGTTGCCAGAATTATTTGTTTGAAGCAGAGAAGAGTACCACAGCTGTTTCAAATAGTGATATGCATGTGA
>seq1.2:330nt
ATGTTGGGGCTAATCATGAAGATGAAGCCCTTTTTGGAAACCTTTTTTGTGAAGCTAACCGGCCTGTTGGATTACCAGATGGAGTCGAAGAACTACCCACAGCTGTTACTTTTGAAAGCTATCACTTGCCAATCCAAGCTGCTTCAGAATTACTGCTCTTTATTAAAGTTGGTATATTTTCCCCAGAATGGGATAATAGTATTTATGAGAATGCTTCCAGAATGGTCAATGAGAAGCACATTGATTGGCTTCTTCCTATTGTTGGTTGCCAGAATTATTTGTTTGAAGCAGAGAAGAGTACCACAGCTGTTTCAAATAGTGATATGCTGA
>seq1.3:327nt
ATGTTGGGGCTAATCATGAAGATGAAGCCCTTTTTGGAAACCTTTTTTGTGAAGCTAACCGGCCTGTTGGATTACCAGATGGAGTCGAAGAACTACCCACAGCTGTTACTTTTGAAAGCTATCACTTGCCAATCCAAGCTGCTTCAGAATTACTGCTCTTTATTAAAGTTGGTATATTTTCCCCAGAATGGGATAATAGTATTTATGAGAATGCTTCCAGAATGGTCAATGAGAAGCACATTGATTGGCTTCTTCCTATTGTTGGTTGCCAGAATTATTTGTTTGAAGCAGAGAAGAGTACCACAGCTGTTTCAAATAGTGATATGA
>seq2.1:300nt
ATGTCGGAATTGCGAGTAAGCACCAGCTTCTCAGCATTTTTTTGGAAACCAACTGATTTTGGATTCAATGATGCTGATCCAAAACTATTATTTGTGCTGAGTTTTGATGGATATCTTTCAATGGACTTTTTGCTAGCTCCACAATCTCCCAAAAAAGAGCAAATAAAATTAAAAAGGAATTTTAGGCCGAGAAGAAAATCCTCGCTATCTGCAAGCTTCACCATTAGCTGCACAATTTTCTCCAAAAGTAGGTTCAACGATGCCATTCCATGCAAAAGCTGGAGCATAAAACCAAAATAA
>seq2.2:315nt
ATGGATGCAGAGGCATTTTCGGAATTGCGAGTAAGCACCAGCTTCTCAGCATTTTTTTGGAAACCAACTGATTTTGGATTCAATGATGCTGATCCAAAACTATTATTTGTGCTGAGTTTTGATGGATATCTTTCAATGGACTTTTTGCTAGCTCCACAATCTCCCAAAAAAGAGCAAATAAAATTAAAAAGGAATTTTAGGCCGAGAAGAAAATCCTCGCTATCTGCAAGCTTCACCATTAGCTGCACAATTTTCTCCAAAAGTAGGTTCAACGATGCCATTCCATGCAAAAGCTGGAGCATAAAACCAAAATAA
```
#### output.fasta
```$xslt
>seq1.1:333nt
ATGTTGGGGCTAATCATGAAGATGAAGCCCTTTTTGGAAACCTTTTTTGTGAAGCTAACCGGCCTGTTGGATTACCAGATGGAGTCGAAGAACTACCCACAGCTGTTACTTTTGAAAGCTATCACTTGCCAATCCAAGCTGCTTCAGAATTACTGCTCTTTATTAAAGTTGGTATATTTTCCCCAGAATGGGATAATAGTATTTATGAGAATGCTTCCAGAATGGTCAATGAGAAGCACATTGATTGGCTTCTTCCTATTGTTGGTTGCCAGAATTATTTGTTTGAAGCAGAGAAGAGTACCACAGCTGTTTCAAATAGTGATATGCATGTGA
>seq2.2:315nt
ATGGATGCAGAGGCATTTTCGGAATTGCGAGTAAGCACCAGCTTCTCAGCATTTTTTTGGAAACCAACTGATTTTGGATTCAATGATGCTGATCCAAAACTATTATTTGTGCTGAGTTTTGATGGATATCTTTCAATGGACTTTTTGCTAGCTCCACAATCTCCCAAAAAAGAGCAAATAAAATTAAAAAGGAATTTTAGGCCGAGAAGAAAATCCTCGCTATCTGCAAGCTTCACCATTAGCTGCACAATTTTCTCCAAAAGTAGGTTCAACGATGCCATTCCATGCAAAAGCTGGAGCATAAAACCAAAATAA
```

### Pipe for streamlined analysis

```$xslt
cat input.fasta \
| cdskit pad --seqfile - --outfile - \
| cdskit aggregate --seqfile - --outfile - \
> output.fasta
```

# Licensing
This program is BSD-licensed (3 clause). See [LICENSE](LICENSE) for details.

